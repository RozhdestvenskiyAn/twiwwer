# _Бизнес требования_

1. Публикация фраз с тегами;
2. Чтение своих фраз;
3. Подписываться на других пользователей
4. Читать фразы других пользователей
5. Оценивать фразы других пользователей

## _1 Публикация фраз с тегами_

**Входящие данные** <br>
GWT в cookie (twiwwer) аутентифицированного пользлвателя (**Все последующие пунккты** )

```json
{
  "text": "first phrase",
  "tags": [
    "first",
    "phrase"
  ]
}
```

**Валидация** <br>
text >= 1 символа, <= 150 символов <br>
tags от 0 до 5, значение от >= 3 символов, <= 25, разрешенные символы a-zA-Z0-9а-яА-Я<br>

**Логика метода** <br>
сервис проверяет наличие GWT в cookie twiwwer аутентифирированого пользователя,
если не находит - возвращает код ошибки "AUTHORIZATION_ERROR",
иначе валидируется запрос, если не валидный возвращает код ошибки "REQUEST_VALIDATION_ERROR",
записывает фразу в таблицу phrase,
по каждому тегу проверяет есть ли в таблице tag такой тег, если нет - записывает,
получает id всех тегов, записывает id фразы и тегов в таблицу phrase_tag

**Исходящие данные в случае успеха** <br>
статус 200

```json
{}
```

**Исходящие данные в случае ошибки** <br>
статус 401

```json
{
  "error": {
    "code": "AUTHORIZATION_ERROR",
    "message": "Nick name is already token"
  }
}
```

статус 400

```json
{
  "error": {
    "code": "REQUEST_VALIDATION_ERROR",
    "message": "Request json is not valid, errors of validation ... "
  }
}
```

## _2. Получение своих фраз с тегами _

**Входящие данные** <br>
GET /api/myPhrases

**Логика метода** <br>
Сервис получает по id пользователя его фразы, по id фраз получает теги к каждой фразе,
упорядочивает фразы по времени от новым к старым и отсылает юзеру

**Исходящие данные в случае успеха** <br>
статус 200

```json
{
  "data": {
    "phrases": [
      {
        "id": 9,
        "text": "Сегодня солнечный день - 5",
        "timeInsert": "2022-11-14 16:12:15",
        "tags": [
          "погода",
          "новый тег"
        ]
      },
      {
        "id": 8,
        "text": "Сегодня солнечный день - 4",
        "timeInsert": "2022-11-14 16:09:17",
        "tags": [
          "погода",
          "солнце",
          "хороший день"
        ]
      }
    ]
  }
}
```